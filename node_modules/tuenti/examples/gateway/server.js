var Tuenti = require('tuenti'), 
	Http = require('http'),
	Url = require('url'),
	Qs = require('querystring'),
	Fs = require('fs');

Http.createServer(function(request, response) {

	var uri = Url.parse(request.url); 

	response.writeHead(200, { 'Content-Type' : 'text/html' });  

	if (uri.pathname == '/tuenti') { // tuenti request

		var data = Qs.parse(uri.query); // parse query
		
		Tuenti.gateway(data, function(buffer) {
		
			// Send tuenti response to local server 
		
			response.end(JSON.stringify(buffer));
			
		});

	} else { // default request
	
		// load html
		
		response.end(Fs.readFileSync('index.html', 'utf-8'));  

	}

}).listen(8080);

console.log('Server running at http://127.0.0.1:8080');