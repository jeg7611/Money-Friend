<!DOCTYPE html><html>

	<head>
	
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<script type="text/javascript" src="https://raw.github.com/douglascrockford/JSON-js/master/json2.js"></script>
		
		<script type="text/javascript" src="https://raw.github.com/yeikos/nodejs.tuenti/master/lib/jquery.tuenti.js"></script>

		<script type="text/javascript">
		
			var $result, $status;

			$(function() {
			
				$result = $('#result');
				$status = $('#status');
				
				$('form').submit(function(event) {
					
					var email = $('input[name=email]', this).val(),
						password = $('input[name=password]', this).val();
					
					$.tuenti.login(email, password, function(request, response) {
										
						if (response.error) {
						
							// login incorrect
						
							$status.css('color', 'red').text('Login incorrect');
			
						} else { 
						
							// login correct
						
							$status.css('color', 'green').text('Login correct');
							
							success(request);
							
						}
					
					});
					
					event.preventDefault();
					
				});
			
			});
			
			function success(request) {

				$status.css('color', 'green').text('Loading friends...');
				
				request('getFriendsData', function(response) {
				
					// reset output
					
					$('<h3></h3>').text('My friends').appendTo(
					
						$result.empty().css('color', 'black') 
						
					);
				
					var $ul = $('<ul></ul>').appendTo($result);
					
					// show friends
					
					$.each(response[0], function(index, item) {
						
						$('<li></li>').html(item.name).appendTo($ul);
		
					});

					$status.css('color', 'green').text('Ready');
			
				});
				
			}
			
		</script>

	</head>

	<body>
		
		<form>
		
			<input type="text" name="email" placeholder="email">
			<input type="password" name="password" placeholder="password">
			
			<input type="submit">

			<span id="status"></span>
			
		</form>
		
		<div id="result"></div>
		
	</body>

</html>